<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Chat</title>
    <link rel="stylesheet" href="sidepanel.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <span class="app-title">Gemini Chat</span>
            </div>
            <div class="header-right">
                <button id="new-chat-button" class="icon-button" title="New Chat">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14M5 12h14" />
                    </svg>
                </button>
                <button id="settings-button" class="icon-button" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                </button>
            </div>
        </header>

        <main id="chat-messages" class="chat-messages">
            <div class="welcome-message">
                <div class="welcome-icon">‚ú®</div>
                <h2>Welcome to Gemini Chat</h2>
                <p>Start a conversation or try one of these:</p>
                <div class="quick-actions">
                    <button class="quick-action-btn" data-prompt="Summarize this page">üìù Summarize</button>
                    <button class="quick-action-btn" data-prompt="Help me understand and learn from this page">üìö Help
                        me learn</button>
                    <button class="quick-action-btn" data-prompt="Research and fact-check the claims on this page">üîç
                        Fact
                        check</button>
                </div>
            </div>
        </main>

        <!-- Input Area -->
        <footer class="input-area">
            <div class="input-box">
                <!-- Image Preview Area -->
                <div id="image-preview-area" class="image-preview-area hidden"></div>

                <!-- Textarea -->
                <textarea id="message-input" placeholder="Ask anything..." rows="1"></textarea>

                <!-- Bottom Controls -->
                <div class="input-controls">
                    <div class="input-controls-left">
                        <!-- Add Image Button -->
                        <button id="add-image-button" class="control-button" title="Add image">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                        </button>
                        <!-- Page Context -->
                        <label class="page-context-toggle" id="page-context-label" title="Include current page content">
                            <input type="checkbox" id="include-page" checked>
                            <img id="page-favicon" class="page-favicon" src="" alt="" />
                            <span id="page-title" class="page-title">Á∂≤È†Å</span>
                        </label>
                    </div>
                    <div class="input-controls-right">
                        <!-- Model Select -->
                        <select id="model-select" class="inline-model-select">
                            <option value="">Select Model</option>
                        </select>
                        <!-- Send Button -->
                        <button id="send-button" class="send-button" title="Send message" disabled>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Hidden file input -->
            <input type="file" id="image-file-input" accept="image/*" multiple hidden>
        </footer>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚öôÔ∏è Settings</h2>
                    <button id="close-settings" class="close-button">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- Backend Type -->
                    <div class="setting-group">
                        <label class="setting-label">Backend Type</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="backend-type" value="gemini" checked>
                                <span>Gemini API</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="backend-type" value="openai">
                                <span>OpenAI Compatible</span>
                            </label>
                        </div>
                    </div>

                    <!-- Gemini Settings -->
                    <div id="gemini-settings" class="backend-settings">
                        <div class="setting-group">
                            <label class="setting-label" for="gemini-api-url">API URL</label>
                            <input type="text" id="gemini-api-url" class="setting-input"
                                value="https://generativelanguage.googleapis.com/v1beta"
                                placeholder="https://generativelanguage.googleapis.com/v1beta">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label" for="gemini-api-key">API Key</label>
                            <input type="password" id="gemini-api-key" class="setting-input"
                                placeholder="Enter your Gemini API key">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Models</label>
                            <div id="gemini-models" class="model-list"></div>
                            <div class="add-model">
                                <input type="text" id="gemini-new-model" class="setting-input"
                                    placeholder="Add model name">
                                <button id="gemini-add-model" class="add-button">+</button>
                            </div>
                        </div>
                    </div>

                    <!-- OpenAI Settings -->
                    <div id="openai-settings" class="backend-settings hidden">
                        <div class="setting-group">
                            <label class="setting-label" for="openai-api-url">API URL</label>
                            <input type="text" id="openai-api-url" class="setting-input"
                                value="http://localhost:11434/v1" placeholder="http://localhost:11434/v1">
                            <small class="setting-hint">Supports localhost, Ollama, LM Studio, etc.</small>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label" for="openai-api-key">API Key (optional)</label>
                            <input type="password" id="openai-api-key" class="setting-input"
                                placeholder="Enter API key (optional for local)">
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">Models</label>
                            <div id="openai-models" class="model-list"></div>
                            <div class="add-model">
                                <input type="text" id="openai-new-model" class="setting-input"
                                    placeholder="Add model name">
                                <button id="openai-add-model" class="add-button">+</button>
                            </div>
                        </div>
                    </div>

                    <!-- System Prompt -->
                    <div class="setting-group">
                        <label class="setting-label" for="system-prompt">System Prompt</label>
                        <textarea id="system-prompt" class="setting-textarea"
                            placeholder="Enter system prompt (optional)" rows="4"></textarea>
                    </div>

                    <!-- Theme -->
                    <div class="setting-group">
                        <label class="setting-label">Theme</label>
                        <div class="radio-group theme-radio-group">
                            <label class="radio-label" title="Light theme">
                                <input type="radio" name="theme" value="light">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <circle cx="12" cy="12" r="5" />
                                    <line x1="12" y1="1" x2="12" y2="3" />
                                    <line x1="12" y1="21" x2="12" y2="23" />
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                                    <line x1="1" y1="12" x2="3" y2="12" />
                                    <line x1="21" y1="12" x2="23" y2="12" />
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                                </svg>
                                <span>Light</span>
                            </label>
                            <label class="radio-label" title="Dark theme">
                                <input type="radio" name="theme" value="dark">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                                </svg>
                                <span>Dark</span>
                            </label>
                            <label class="radio-label" title="Follow system preference">
                                <input type="radio" name="theme" value="auto" checked>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2" />
                                    <line x1="8" y1="21" x2="16" y2="21" />
                                    <line x1="12" y1="17" x2="12" y2="21" />
                                </svg>
                                <span>Auto</span>
                            </label>
                        </div>
                    </div>

                    <!-- Feature Toggles -->
                    <div class="setting-group">
                        <label class="setting-label">Features</label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="enable-search" checked>
                            <span>Enable Search / Tool Calling</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="include-thinking" checked>
                            <span>Include Thinking in Response</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="auto-include-page" checked>
                            <span>Auto-include Page Context</span>
                        </label>
                    </div>

                    <!-- Error Message -->
                    <div id="settings-error" class="error-message hidden"></div>
                </div>
                <div class="modal-footer">
                    <button id="reset-settings" class="button button-secondary" style="margin-right: auto;">Reset
                        Default</button>
                    <button id="cancel-settings" class="button button-secondary">Cancel</button>
                    <button id="save-settings" class="button button-primary">Save</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="sidepanel.js"></script>
</body>

</html>