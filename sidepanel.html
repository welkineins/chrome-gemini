<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gemini Chat</title>
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <select id="model-select" class="model-select">
          <option value="">Select Model</option>
        </select>
      </div>
      <div class="header-right">
        <button id="new-chat-button" class="icon-button" title="New Chat">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 5v14M5 12h14"/>
          </svg>
        </button>
        <button id="settings-button" class="icon-button" title="Settings">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Chat Messages -->
    <main id="chat-messages" class="chat-messages">
      <div class="welcome-message">
        <div class="welcome-icon">‚ú®</div>
        <h2>Welcome to Gemini Chat</h2>
        <p>Start a conversation or configure your settings</p>
      </div>
    </main>

    <!-- Input Area -->
    <footer class="input-area">
      <div class="input-options">
        <label class="checkbox-label">
          <input type="checkbox" id="include-page" checked>
          <span>üìÑ Include page content</span>
        </label>
      </div>
      <div class="input-container">
        <textarea id="message-input" placeholder="Type your message..." rows="1"></textarea>
        <button id="send-button" class="send-button" disabled>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
          </svg>
        </button>
      </div>
    </footer>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>‚öôÔ∏è Settings</h2>
          <button id="close-settings" class="close-button">&times;</button>
        </div>
        <div class="modal-body">
          <!-- Backend Type -->
          <div class="setting-group">
            <label class="setting-label">Backend Type</label>
            <div class="radio-group">
              <label class="radio-label">
                <input type="radio" name="backend-type" value="gemini" checked>
                <span>Gemini API</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="backend-type" value="openai">
                <span>OpenAI Compatible</span>
              </label>
            </div>
          </div>

          <!-- Gemini Settings -->
          <div id="gemini-settings" class="backend-settings">
            <div class="setting-group">
              <label class="setting-label" for="gemini-api-url">API URL</label>
              <input type="text" id="gemini-api-url" class="setting-input" 
                     value="https://generativelanguage.googleapis.com/v1beta"
                     placeholder="https://generativelanguage.googleapis.com/v1beta">
            </div>
            <div class="setting-group">
              <label class="setting-label" for="gemini-api-key">API Key</label>
              <input type="password" id="gemini-api-key" class="setting-input" 
                     placeholder="Enter your Gemini API key">
            </div>
            <div class="setting-group">
              <label class="setting-label">Models</label>
              <div id="gemini-models" class="model-list"></div>
              <div class="add-model">
                <input type="text" id="gemini-new-model" class="setting-input" placeholder="Add model name">
                <button id="gemini-add-model" class="add-button">+</button>
              </div>
            </div>
          </div>

          <!-- OpenAI Settings -->
          <div id="openai-settings" class="backend-settings hidden">
            <div class="setting-group">
              <label class="setting-label" for="openai-api-url">API URL</label>
              <input type="text" id="openai-api-url" class="setting-input" 
                     value="http://localhost:11434/v1"
                     placeholder="http://localhost:11434/v1">
              <small class="setting-hint">Supports localhost, Ollama, LM Studio, etc.</small>
            </div>
            <div class="setting-group">
              <label class="setting-label" for="openai-api-key">API Key (optional)</label>
              <input type="password" id="openai-api-key" class="setting-input" 
                     placeholder="Enter API key (optional for local)">
            </div>
            <div class="setting-group">
              <label class="setting-label">Models</label>
              <div id="openai-models" class="model-list"></div>
              <div class="add-model">
                <input type="text" id="openai-new-model" class="setting-input" placeholder="Add model name">
                <button id="openai-add-model" class="add-button">+</button>
              </div>
            </div>
          </div>

          <!-- System Prompt -->
          <div class="setting-group">
            <label class="setting-label" for="system-prompt">System Prompt</label>
            <textarea id="system-prompt" class="setting-textarea" 
                      placeholder="Enter system prompt (optional)"
                      rows="4"></textarea>
          </div>

          <!-- Feature Toggles -->
          <div class="setting-group">
            <label class="setting-label">Features</label>
            <label class="checkbox-label">
              <input type="checkbox" id="enable-search" checked>
              <span>Enable Search / Tool Calling</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="include-thinking" checked>
              <span>Include Thinking in Response</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="auto-include-page" checked>
              <span>Auto-include Page Context</span>
            </label>
          </div>

          <!-- Error Message -->
          <div id="settings-error" class="error-message hidden"></div>
        </div>
        <div class="modal-footer">
          <button id="cancel-settings" class="button button-secondary">Cancel</button>
          <button id="save-settings" class="button button-primary">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="sidepanel.js"></script>
</body>
</html>
